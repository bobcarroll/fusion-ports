<?xml version="1.0" encoding="utf-8"?>
<Port api="1">
  <Keywords>
    <Keyword>x86</Keyword>
    <Keyword>x86_64</Keyword>
  </Keywords>
  <Sources>
    <File uri="http://python.org/ftp/python/3.3.0/python-3.3.0.msi"
          digest="70062e4b9a1f959f5e07555e471c5657"
          size="19980288"
          cpuarch="x86" />
    <File uri="http://python.org/ftp/python/3.3.0/python-3.3.0.amd64.msi"
          digest="5129376df1c56297a80e69a1a6144b4e"
          size="20508672"
          cpuarch="amd64" />
  </Sources>
  <Slot>2</Slot>
  <Dependencies>
    <Package atom="&gt;=sys-utils/msi-tasks-2.0.1" />
  </Dependencies>
  <Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
    <PropertyGroup>
      <ExtensionTasksPath>$(BINDIR)ExtensionPack\</ExtensionTasksPath>
      <InstallDir>Program Files\Python\3.3\</InstallDir>
      <StartMenu>$(L)Python 3.3\</StartMenu>
    </PropertyGroup>
    <Import Project="$(BINDIR)Fusion.tasks" />
    <Import Project="$(ExtensionTasksPath)MSBuild.ExtensionPack.tasks" />
    <Import Project="$(BINDIR)msi.tasks" />
    <Target Name="src_unpack">
      <Fusion.Tasks.MSI.Dump MsiPath="$(DISTDIR)$(P).msi"
                             DumpDir="$(WORKDIR)"
                             TempDir="$(T)"
                             CabFiles="true" />
    </Target>
    <Target Name="src_install">
      <MakeDir Directories="$(D)$(InstallDir)" />
      <Fusion.Tasks.MSI.MakeImage Target="TARGETDIR"
                                  DumpDir="$(WORKDIR)"
                                  ImageDir="$(D)$(InstallDir)" />
      <MSBuild.ExtensionPack.FileSystem.Folder TaskAction="Move"
                                               Path="$(D)$(InstallDir)Win"
                                               TargetPath="$(T)Win" />
      <MakeDir Directories="$(D)Windows\System32\" />
      <Fusion.Tasks.MSI.MakeImage Target="DLLDIR"
                                  DumpDir="$(WORKDIR)"
                                  ImageDir="$(D)Windows\System32\" />
      <MakeDir Directories="$(StartMenu)" />
      <MSBuild.ExtensionPack.Computer.WshShell TaskAction="CreateShortcut"
                                               Name="$(StartMenu)IDLE (Python GUI).lnk"
                                               FilePath="$(ROOT)$(InstallDir)Lib\idlelib\idle.pyw" />
      <MSBuild.ExtensionPack.Computer.WshShell TaskAction="CreateShortcut"
                                               Name="$(StartMenu)Module Docs.lnk"
                                               FilePath="$(ROOT)$(InstallDir)Tools\scripts\pydocgui.pyw" />
      <MSBuild.ExtensionPack.Computer.WshShell TaskAction="CreateShortcut"
                                               Name="$(StartMenu)Python (command line).lnk"
                                               FilePath="$(ROOT)$(InstallDir)python.exe" />
      <MSBuild.ExtensionPack.Computer.WshShell TaskAction="CreateShortcut"
                                               Name="$(StartMenu)Python Manuals.lnk"
                                               FilePath="$(ROOT)$(InstallDir)Doc\python273.chm" />
    </Target>
    <Target Name="pkg_postinst">
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="CreateKey"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Python\PythonCore\3.3\Help\Main Python Documentation" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="Set"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Python\PythonCore\3.3\Help\Main Python Documentation"
                                               Data="$(ROOT)$(InstallDir)Doc\python273.chm" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="CreateKey"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Python\PythonCore\3.3\Modules" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="CreateKey"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Python\PythonCore\3.3\InstallPath\InstallGroup" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="Set"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Python\PythonCore\3.3\InstallPath"
                                               Data="$(ROOT)$(InstallDir)" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="Set"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Python\PythonCore\3.3\InstallPath\InstallGroup"
                                               Data="Python 3.3" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="CreateKey"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Python\PythonCore\3.3\PythonPath" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="Set"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Python\PythonCore\3.3\PythonPath"
                                               Data="$(ROOT)$(InstallDir)Lib;$(ROOT)$(InstallDir)DLLs;$(ROOT)$(InstallDir)Lib\lib-tk" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="CreateKey"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Classes\.py" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="Set"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Classes\.py"
                                               Data="Python.File" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="Set"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Classes\.py"
                                               Value="Content Type"
                                               Data="text/plain" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="CreateKey"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Classes\.pyw" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="Set"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Classes\.pyw"
                                               Data="Python.NoConFile" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="Set"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Classes\.pyw"
                                               Value="Content Type"
                                               Data="text/plain" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="CreateKey"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Classes\.pyc" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="Set"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Classes\.pyc"
                                               Data="Python.CompiledFile" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="CreateKey"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Classes\.pyo" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="Set"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Classes\.pyo"
                                               Data="Python.CompiledFile" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="CreateKey"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Classes\Python.File" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="Set"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Classes\Python.File"
                                               Data="Python File" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="CreateKey"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Classes\Python.File\DefaultIcon" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="Set"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Classes\Python.File\DefaultIcon"
                                               Data="$(ROOT)$(InstallDir)DLLs\py.ico" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="CreateKey"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Classes\Python.File\shell\open\command" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="Set"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Classes\Python.File\shell\open\command"
                                               Data="&quot;$(ROOT)$(InstallDir)python.exe&quot; &quot;%1&quot; %*" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="CreateKey"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Classes\Python.File\shellex\DropHandler" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="Set"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Classes\Python.File\shellex\DropHandler"
                                               Data="{60254CA5-953B-11CF-8C96-00AA00B8708C}" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="CreateKey"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Classes\Python.NoConFile" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="Set"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Classes\Python.NoConFile"
                                               Data="Python File (no console)" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="CreateKey"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Classes\Python.NoConFile\DefaultIcon" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="Set"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Classes\Python.NoConFile\DefaultIcon"
                                               Data="$(ROOT)$(InstallDir)DLLs\py.ico" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="CreateKey"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Classes\Python.NoConFile\shell\open\command" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="Set"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Classes\Python.NoConFile\shell\open\command"
                                               Data="&quot;$(ROOT)$(InstallDir)pythonw.exe&quot; &quot;%1&quot; %*" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="CreateKey"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Classes\Python.NoConFile\shellex\DropHandler" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="Set"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Classes\Python.NoConFile\shellex\DropHandler"
                                               Data="{60254CA5-953B-11CF-8C96-00AA00B8708C}" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="CreateKey"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Classes\Python.CompiledFile" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="Set"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Classes\Python.CompiledFile"
                                               Data="Compiled Python File" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="CreateKey"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Classes\Python.CompiledFile\DefaultIcon" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="Set"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Classes\Python.CompiledFile\DefaultIcon"
                                               Data="$(ROOT)$(InstallDir)DLLs\pyc.ico" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="CreateKey"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Classes\Python.CompiledFile\shell\open\command" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="Set"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Classes\Python.CompiledFile\shell\open\command"
                                               Data="&quot;$(ROOT)$(InstallDir)pythonw.exe&quot; &quot;%1&quot; %*" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="CreateKey"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Classes\Python.CompiledFile\shellex\DropHandler" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="Set"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Classes\Python.CompiledFile\shellex\DropHandler"
                                               Data="{60254CA5-953B-11CF-8C96-00AA00B8708C}" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="CreateKey"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Microsoft\Windows\CurrentVersion\App Paths\Python.exe" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="Set"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Microsoft\Windows\CurrentVersion\App Paths\Python.exe"
                                               Data="$(ROOT)$(InstallDir)python.exe" />
    </Target>
    <Target Name="pkg_prerm">
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="DeleteKeyTree"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Python\PythonCore\3.3"
                                               ContinueOnError="true" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="DeleteKey"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Python\PythonCore"
                                               ContinueOnError="true" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="DeleteKey"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Python"
                                               ContinueOnError="true" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="DeleteKeyTree"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Classes\.py"
                                               ContinueOnError="true" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="DeleteKeyTree"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Classes\.pyw"
                                               ContinueOnError="true" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="DeleteKeyTree"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Classes\.pyc"
                                               ContinueOnError="true" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="DeleteKeyTree"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Classes\.pyo"
                                               ContinueOnError="true" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="DeleteKeyTree"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Classes\Python.File"
                                               ContinueOnError="true" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="DeleteKeyTree"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Classes\Python.NoConFile"
                                               ContinueOnError="true" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="DeleteKeyTree"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Classes\Python.CompiledFile"
                                               ContinueOnError="true" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="DeleteKeyTree"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Microsoft\Windows\CurrentVersion\App Paths\Python.exe"
                                               ContinueOnError="true" />
    </Target>
  </Project>
</Port>
