<?xml version="1.0" encoding="utf-8"?>
<Port api="1">
  <Keywords>
    <Keyword>x86</Keyword>
    <Keyword>x86_64</Keyword>
  </Keywords>
  <Sources>
    <File uri="http://python.org/ftp/python/2.7.3/python-2.7.3.msi"
          digest="c846d7a5ed186707d3675564a9838cc2"
          size="15867904"
          cpuarch="x86" />
    <File uri="http://python.org/ftp/python/2.7.3/python-2.7.3.amd64.msi"
          digest="d11d4aeb7e5425bf28f28ab1c7452886"
          size="1376768"
          cpuarch="amd64" />
  </Sources>
  <Slot>1</Slot>
  <Dependencies>
    <Package atom="&gt;=sys-utils/msi-tasks-2.0.1" />
  </Dependencies>
  <Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
    <PropertyGroup>
      <ExtensionTasksPath>$(BINDIR)ExtensionPack\</ExtensionTasksPath>
      <InstallDir Condition="$(BITNESS) == '64'">Program Files\Python\2.7\</InstallDir>
      <InstallDir Condition="$(BITNESS) == '32'">Program Files (x86)\Python\2.7\</InstallDir>
      <StartMenu>$(L)Python 2.7\</StartMenu>
    </PropertyGroup>
    <Import Project="$(BINDIR)Fusion.tasks" />
    <Import Project="$(ExtensionTasksPath)MSBuild.ExtensionPack.tasks" />
    <Import Project="$(BINDIR)msi.tasks" />
    <Target Name="src_unpack">
      <Fusion.Tasks.MSI.Dump MsiPath="$(DISTDIR)$(P).msi"
                             DumpDir="$(WORKDIR)"
                             TempDir="$(T)"
                             CabFiles="true" />
    </Target>
    <Target Name="src_install">
      <MakeDir Directories="$(D)$(InstallDir)" />
      <Fusion.Tasks.MSI.MakeImage Target="TARGETDIR"
                                  DumpDir="$(WORKDIR)"
                                  ImageDir="$(D)$(InstallDir)" />
      <MSBuild.ExtensionPack.FileSystem.Folder TaskAction="Move"
                                               Path="$(D)$(InstallDir)Windows"
                                               TargetPath="$(T)Windows" />
      <MakeDir Directories="$(D)Windows\System32\" />
      <Fusion.Tasks.MSI.MakeImage Target="DLLDIR"
                                  DumpDir="$(WORKDIR)"
                                  ImageDir="$(D)Windows\System32\" />
      <MakeDir Directories="$(StartMenu)" />
      <MSBuild.ExtensionPack.Computer.WshShell TaskAction="CreateShortcut"
                                               Name="$(StartMenu)IDLE (Python GUI).lnk"
                                               FilePath="$(ROOT)$(InstallDir)Lib\idlelib\idle.pyw" />
      <MSBuild.ExtensionPack.Computer.WshShell TaskAction="CreateShortcut"
                                               Name="$(StartMenu)Module Docs.lnk"
                                               FilePath="$(ROOT)$(InstallDir)Tools\scripts\pydocgui.pyw" />
      <MSBuild.ExtensionPack.Computer.WshShell TaskAction="CreateShortcut"
                                               Name="$(StartMenu)Python (command line).lnk"
                                               FilePath="$(ROOT)$(InstallDir)python.exe" />
      <MSBuild.ExtensionPack.Computer.WshShell TaskAction="CreateShortcut"
                                               Name="$(StartMenu)Python Manuals.lnk"
                                               FilePath="$(ROOT)$(InstallDir)Doc\python273.chm" />
    </Target>
    <Target Name="pkg_postinst">
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="CreateKey"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Python\PythonCore\2.7\Help\Main Python Documentation" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="Set"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Python\PythonCore\2.7\Help\Main Python Documentation"
                                               Data="$(ROOT)$(InstallDir)Doc\python273.chm" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="CreateKey"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Python\PythonCore\2.7\Modules" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="CreateKey"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Python\PythonCore\2.7\InstallPath\InstallGroup" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="Set"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Python\PythonCore\2.7\InstallPath"
                                               Data="$(ROOT)$(InstallDir)" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="Set"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Python\PythonCore\2.7\InstallPath\InstallGroup"
                                               Data="Python 2.7" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="CreateKey"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Python\PythonCore\2.7\PythonPath" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="Set"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Python\PythonCore\2.7\PythonPath"
                                               Data="$(ROOT)$(InstallDir)Lib;$(ROOT)$(InstallDir)DLLs;$(ROOT)$(InstallDir)Lib\lib-tk" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="CreateKey"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Classes\.py" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="Set"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Classes\.py"
                                               Data="Python.File" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="Set"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Classes\.py"
                                               Value="Content Type"
                                               Data="text/plain" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="CreateKey"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Classes\.pyw" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="Set"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Classes\.pyw"
                                               Data="Python.NoConFile" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="Set"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Classes\.pyw"
                                               Value="Content Type"
                                               Data="text/plain" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="CreateKey"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Classes\.pyc" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="Set"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Classes\.pyc"
                                               Data="Python.CompiledFile" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="CreateKey"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Classes\.pyo" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="Set"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Classes\.pyo"
                                               Data="Python.CompiledFile" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="CreateKey"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Classes\Python.File" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="Set"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Classes\Python.File"
                                               Data="Python File" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="CreateKey"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Classes\Python.File\DefaultIcon" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="Set"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Classes\Python.File\DefaultIcon"
                                               Data="$(ROOT)$(InstallDir)DLLs\py.ico" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="CreateKey"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Classes\Python.File\shell\open\command" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="Set"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Classes\Python.File\shell\open\command"
                                               Data="&quot;$(ROOT)$(InstallDir)python.exe&quot; &quot;%1&quot; %*" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="CreateKey"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Classes\Python.File\shellex\DropHandler" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="Set"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Classes\Python.File\shellex\DropHandler"
                                               Data="{60254CA5-953B-11CF-8C96-00AA00B8708C}" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="CreateKey"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Classes\Python.NoConFile" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="Set"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Classes\Python.NoConFile"
                                               Data="Python File (no console)" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="CreateKey"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Classes\Python.NoConFile\DefaultIcon" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="Set"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Classes\Python.NoConFile\DefaultIcon"
                                               Data="$(ROOT)$(InstallDir)DLLs\py.ico" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="CreateKey"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Classes\Python.NoConFile\shell\open\command" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="Set"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Classes\Python.NoConFile\shell\open\command"
                                               Data="&quot;$(ROOT)$(InstallDir)pythonw.exe&quot; &quot;%1&quot; %*" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="CreateKey"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Classes\Python.NoConFile\shellex\DropHandler" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="Set"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Classes\Python.NoConFile\shellex\DropHandler"
                                               Data="{60254CA5-953B-11CF-8C96-00AA00B8708C}" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="CreateKey"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Classes\Python.CompiledFile" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="Set"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Classes\Python.CompiledFile"
                                               Data="Compiled Python File" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="CreateKey"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Classes\Python.CompiledFile\DefaultIcon" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="Set"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Classes\Python.CompiledFile\DefaultIcon"
                                               Data="$(ROOT)$(InstallDir)DLLs\pyc.ico" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="CreateKey"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Classes\Python.CompiledFile\shell\open\command" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="Set"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Classes\Python.CompiledFile\shell\open\command"
                                               Data="&quot;$(ROOT)$(InstallDir)pythonw.exe&quot; &quot;%1&quot; %*" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="CreateKey"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Classes\Python.CompiledFile\shellex\DropHandler" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="Set"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Classes\Python.CompiledFile\shellex\DropHandler"
                                               Data="{60254CA5-953B-11CF-8C96-00AA00B8708C}" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="CreateKey"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Microsoft\Windows\CurrentVersion\App Paths\Python.exe" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="Set"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Microsoft\Windows\CurrentVersion\App Paths\Python.exe"
                                               Data="$(ROOT)$(InstallDir)python.exe" />
    </Target>
    <Target Name="pkg_prerm">
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="DeleteKeyTree"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Python\PythonCore\2.7"
                                               ContinueOnError="true" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="DeleteKey"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Python\PythonCore"
                                               ContinueOnError="true" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="DeleteKey"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Python"
                                               ContinueOnError="true" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="DeleteKeyTree"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Classes\.py"
                                               ContinueOnError="true" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="DeleteKeyTree"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Classes\.pyw"
                                               ContinueOnError="true" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="DeleteKeyTree"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Classes\.pyc"
                                               ContinueOnError="true" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="DeleteKeyTree"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Classes\.pyo"
                                               ContinueOnError="true" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="DeleteKeyTree"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Classes\Python.File"
                                               ContinueOnError="true" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="DeleteKeyTree"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Classes\Python.NoConFile"
                                               ContinueOnError="true" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="DeleteKeyTree"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Classes\Python.CompiledFile"
                                               ContinueOnError="true" />
      <MSBuild.ExtensionPack.Computer.Registry TaskAction="DeleteKeyTree"
                                               RegistryView="Registry64"
                                               RegistryHive="LocalMachine"
                                               Key="Software\Microsoft\Windows\CurrentVersion\App Paths\Python.exe"
                                               ContinueOnError="true" />
    </Target>
  </Project>
</Port>
